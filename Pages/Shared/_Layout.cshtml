@{
    var path      = Context.Request.Path.Value ?? "/en";
    var isArabic  = path.StartsWith("/ar", StringComparison.OrdinalIgnoreCase);
    var lang      = isArabic ? "ar"  : "en";
    var dir       = isArabic ? "rtl" : "ltr";
    var altLang   = isArabic ? "en"  : "ar";
    var altPath   = "/" + altLang + (path.Length > 3 ? path[3..] : string.Empty);
    var pageTitle = ViewData["Title"] as string ?? "Evolution Technology";
    var metaDesc  = ViewData["MetaDescription"] as string
                    ?? "Evolution Technology — System Architecture, Enterprise Development, System Modernization, and Technical Consulting.";
}
<!DOCTYPE html>
<html lang="@lang" dir="@dir">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="@metaDesc" />
    <meta name="robots" content="index, follow" />

    <title>@pageTitle — Evolution Technology</title>

    <!-- Canonical & hreflang -->
    <link rel="canonical" href="https://evolutiontechnology.ly@path" />
    <link rel="alternate" hreflang="en" href="https://evolutiontechnology.ly/en" />
    <link rel="alternate" hreflang="ar" href="https://evolutiontechnology.ly/ar" />

    <!-- Structured data -->
    <script type="application/ld+json">
    {
      "@@context": "https://schema.org",
      "@@type": "Organization",
      "name": "Evolution Technology",
      "url": "https://evolutiontechnology.ly",
      "description": "A technical engineering firm specializing in System Architecture, Enterprise Development, System Modernization, and Technical Consulting.",
      "areaServed": "Worldwide",
      "contactPoint": {
        "@@type": "ContactPoint",
        "contactType": "Customer Support",
        "email": "contact@evolutiontechnology.ly"
      }
    }
    </script>

    <!-- Fonts: English / Arabic -->
    @if (isArabic)
    {
        <link rel="preconnect" href="https://fonts.googleapis.com" />
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous" />
        <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Arabic:wght@300;400;500;600&display=swap" rel="stylesheet" />
    }
    else
    {
        <link rel="preconnect" href="https://fonts.googleapis.com" />
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous" />
        <link href="https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,300;0,14..32,400;0,14..32,500;0,14..32,600;1,14..32,400&family=DM+Mono:wght@400;500&display=swap" rel="stylesheet" />
    }

    <!-- Bootstrap (RTL/LTR) -->
    @if (isArabic)
    {
        <link rel="stylesheet" href="~/lib/bootstrap/dist/css/bootstrap.rtl.min.css" />
    }
    else
    {
        <link rel="stylesheet" href="~/lib/bootstrap/dist/css/bootstrap.min.css" />
    }

    <link rel="stylesheet" href="~/css/site.css" asp-append-version="true" />

    <!-- Inline theme init to prevent FOUC -->
    <script>
        (function () {
            var t = localStorage.getItem('et-theme') || 'light';
            document.documentElement.setAttribute('data-theme', t);
        })();
    </script>
</head>
<body>

    <!-- ═══ HEADER ═════════════════════════════════════════════════════════════ -->
    <header class="et-header" role="banner">
        <nav class="navbar navbar-expand-lg" aria-label="Primary navigation">
            <div class="container">

                <!-- Brand -->
                <a class="navbar-brand et-brand" href="/@lang">
                    <span class="et-brand-mark">ET</span>
                    <span class="et-brand-name">Evolution Technology</span>
                </a>

                <!-- Mobile toggle -->
                <button class="navbar-toggler et-toggler" type="button"
                        data-bs-toggle="collapse" data-bs-target="#primaryNav"
                        aria-controls="primaryNav" aria-expanded="false"
                        aria-label="@(isArabic ? "تبديل القائمة" : "Toggle navigation")">
                    <span class="et-toggler-bar"></span>
                    <span class="et-toggler-bar"></span>
                    <span class="et-toggler-bar"></span>
                </button>

                <!-- Nav links -->
                <div class="collapse navbar-collapse" id="primaryNav">
                    <ul class="navbar-nav @(isArabic ? "me-auto" : "ms-auto") align-items-lg-center gap-lg-1">
                        <li class="nav-item">
                            <a class="nav-link" href="/@lang">
                                @(isArabic ? "الرئيسية" : "Home")
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="/@lang/about">
                                @(isArabic ? "من نحن" : "About")
                            </a>
                        </li>
                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle" href="/@lang/services"
                               role="button" data-bs-toggle="dropdown" aria-expanded="false">
                                @(isArabic ? "الخدمات" : "Services")
                            </a>
                            <ul class="dropdown-menu et-dropdown">
                                <li>
                                    <a class="dropdown-item" href="/@lang/services/architecture">
                                        @(isArabic ? "هندسة الأنظمة والبنية التحتية" : "System Architecture & Engineering")
                                    </a>
                                </li>
                                <li>
                                    <a class="dropdown-item" href="/@lang/services/development">
                                        @(isArabic ? "تطوير الأنظمة المؤسسية" : "Enterprise System Development")
                                    </a>
                                </li>
                                <li>
                                    <a class="dropdown-item" href="/@lang/services/modernization">
                                        @(isArabic ? "التحديث والتكامل" : "Modernization & Integration")
                                    </a>
                                </li>
                                <li>
                                    <a class="dropdown-item" href="/@lang/services/consulting">
                                        @(isArabic ? "الاستشارات التقنية" : "Technical Consulting")
                                    </a>
                                </li>
                            </ul>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="/@lang/contact">
                                @(isArabic ? "تواصل معنا" : "Contact")
                            </a>
                        </li>
                    </ul>

                    <!-- Controls: language + theme -->
                    <div class="et-nav-controls d-flex align-items-center gap-2 @(isArabic ? "me-lg-3" : "ms-lg-3")">
                        <!-- Language switcher -->
                        <a href="@altPath" class="et-lang-btn" title="@(isArabic ? "English" : "العربية")"
                           aria-label="@(isArabic ? "Switch to English" : "التبديل إلى العربية")">
                            @(isArabic ? "EN" : "ع")
                        </a>

                        <!-- Theme toggle -->
                        <button id="themeToggle" class="et-theme-btn" type="button"
                                aria-label="Toggle dark/light mode" title="Toggle theme">
                            <span class="et-theme-icon et-icon-light">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>
                            </span>
                            <span class="et-theme-icon et-icon-dark">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/></svg>
                            </span>
                        </button>
                    </div>
                </div>
            </div>
        </nav>
    </header>

    <!-- ═══ MAIN ══════════════════════════════════════════════════════════════ -->
    <main role="main" id="main-content">
        @RenderBody()
    </main>

    <!-- ═══ FOOTER ════════════════════════════════════════════════════════════ -->
    <footer class="et-footer" role="contentinfo">
        <div class="container">
            <div class="et-footer-grid">
                <div class="et-footer-brand">
                    <span class="et-brand-mark">ET</span>
                    <p class="et-footer-tagline">
                        @(isArabic
                            ? "شريك تقني طويل الأمد في هندسة الأنظمة المؤسسية."
                            : "A long-term technical partner in enterprise system engineering.")
                    </p>
                </div>

                <nav class="et-footer-nav" aria-label="@(isArabic ? "روابط التذييل" : "Footer navigation")">
                    <h3 class="et-footer-heading">@(isArabic ? "الصفحات" : "Pages")</h3>
                    <ul class="list-unstyled">
                        <li><a href="/@lang">@(isArabic ? "الرئيسية" : "Home")</a></li>
                        <li><a href="/@lang/about">@(isArabic ? "من نحن" : "About")</a></li>
                        <li><a href="/@lang/services">@(isArabic ? "الخدمات" : "Services")</a></li>
                        <li><a href="/@lang/contact">@(isArabic ? "تواصل معنا" : "Contact")</a></li>
                    </ul>
                </nav>

                <nav class="et-footer-nav" aria-label="@(isArabic ? "روابط الخدمات" : "Services navigation")">
                    <h3 class="et-footer-heading">@(isArabic ? "الخدمات" : "Services")</h3>
                    <ul class="list-unstyled">
                        <li><a href="/@lang/services/architecture">@(isArabic ? "هندسة الأنظمة" : "System Architecture")</a></li>
                        <li><a href="/@lang/services/development">@(isArabic ? "تطوير المؤسسات" : "Enterprise Development")</a></li>
                        <li><a href="/@lang/services/modernization">@(isArabic ? "التحديث والتكامل" : "Modernization")</a></li>
                        <li><a href="/@lang/services/consulting">@(isArabic ? "الاستشارات التقنية" : "Consulting")</a></li>
                    </ul>
                </nav>

                <div class="et-footer-contact">
                    <h3 class="et-footer-heading">@(isArabic ? "التواصل" : "Contact")</h3>
                    <a href="mailto:contact@evolutiontechnology.ly" class="et-footer-email">
                        contact@evolutiontechnology.ly
                    </a>
                </div>
            </div>

            <div class="et-footer-bottom">
                <p>
                    &copy; @DateTime.UtcNow.Year Evolution Technology.
                    @(isArabic ? "جميع الحقوق محفوظة." : "All rights reserved.")
                </p>
                <p class="et-footer-alt-lang">
                    <a href="@altPath">@(isArabic ? "English" : "العربية")</a>
                </p>
            </div>
        </div>
    </footer>

    <!-- Scripts -->
    <script src="~/lib/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
    <script src="~/js/site.js" asp-append-version="true"></script>

    @await RenderSectionAsync("Scripts", required: false)
</body>
</html>
